# POST to $pipe_name
import requests
import json

# URL
url = "$protocol://$hostname/pipeline/$pipe_id/task?token=$token"

# Define the file and JSON data
files = {'document': ('image.png', open('image.png', 'rb'), 'image/png')}
json_data = json.dumps({'filename': ["image.png"]})

# Send the request with both file and JSON data
response = requests.post(url, files=files, data=json_data, headers={'Content-Type': 'application/json'})

if response.status_code == 200:
    print(response.text)
else:
    print(response.status_code)